extends layout.pug

include utils.pug

append head
	//- add page specific styles by appending to the head
	link(rel="stylesheet" href="/stylesheets/index.css")
	link(rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons")
	//- add page specific js
	script(src="/javascripts/edit-question.js" type="module" defer)

block content

	div(class='questionContainer')
		div(class='main-links all-btn back-btn')
			a(href='/questions' class='btn log-in-submit btn2') Go to Questions
		if question
			if locals.authenticated
				div(class="logged-in-container")
					div(class="question-stats-container")
						div(class='test-2')
							p(class='vote-count-1') #{qVotes|0}
						div(class="question-stats-votes logged-in-votes")
							form(action=`/questions/${question.id}/votes` method='post')
								input(type='hidden' name='qUpVote' value=1)
								button(class='arrow-up-container hide-btn')
									div(class='arrow-up')
							//- a(href=`/questions/delete/${question.id}` class='arrow-up-container')
							//- 	div(class='arrow-up')
							div(class='up-votes') upVote
							div(class='down-votes') downVote
							form(action=`/questions/${question.id}/votes` method='post')
								input(type='hidden' name='qDownVote' value=0)
								button(class='arrow-up-container hide-btn')
									div(class='arrow-down')
							//- a(href=`/questions/delete/${question.id}` class='arrow-down-container')
							//- 	div(class='arrow-down')
					div(class='question-summary-container')
						div(class="question-summary edit-question-question")
							div(class="question single-question")
								p(id='questionContent' class="question single-question") #{question.content}
								div(class='edit-form' id='test')
									//- +validationErrorSummary(errors)
									p(id='errorUpdateQuestion' class='edit-errors')
									form(action=`/questions/${question.id}` method='post' id='updateQuestionContent' style='display:none;')
										input( style='display:none' name='questionId' value=question.id)
										textarea(name="questionContent" id='textareaUpdateQuestion' class='edit-input') #{question.content}
										//- button(id='submitUpdateQuestionButton' class='log-in-submit new-question-btn edit-submit-btn edit-cancel-btn') Submit Update
					div(class="question-summary-footer")
						div(class="question-summary-user")
							div(class="question-summary-info")
								<span class='asked-by'>asked by: <span class='time'>#{question.User.username}</span></span>
									div(class='edit-btns')
										button(type='submit' form='updateQuestionContent' id='submitUpdateQuestionButton' class='log-in-submit new-question-btn edit-submit-btn edit-cancel-btn' style='display:none;') Submit Update
										button(id='cancelUpdateQuestionButton' class='log-in-submit new-question-btn edit-cancel-btn' style='display:none;') Cancel Update
				if locals.user.id === question.User.id
					div(class='single-question-btns')
						a(href=`/questions/delete/${question.id}` class='btn log-in-submit delete-btn') Delete Question
						button(id='updateQuestionButton' class='btn log-in-submit edit-btn') Edit Question

			div(class='log-in-form question-post answers-container')
				div
					//- p(class='answers-title subtitle-1') flo-Answers!
				div(class="logged-in-container answer-container")
					div(class="question-stats-container answer-username-container")
						div(class='up-votes answer-username') pawan087
					div(class='question-summary-container')
						div(class="question-summary edit-question-question")
							div(id='questionContent' class="question answer single-question") This is my answer to you.
								div(class='edit-form')
									form(action=`/questions/${question.id}` method='post' id='updateAnswerContent')
										input( style='display:none' name='answerId' value=question.id)
										textarea(name="answerContent" id='textareaUpdateAnswer' class='edit-input edit-text-area answer-text-area') This is my answer to you. 

					div(class="question-summary-footer")
						div(class="question-summary-user")
							div(class='single-question-btns answer-btns')
								a(href=`/questions/delete/${question.id}` class='btn log-in-submit delete-btn answer-delete') Delete Answer
								a(href=`/questions/delete/${question.id}` class='btn log-in-submit delete-btn answer-delete answer-edit') Edit Answer
								//- <span class='asked-by'>asked by: <span class='time'>#{question.User.username}</span></span>

				div(class='single-question-btns')

			form(action='#' method='post' class='log-in-form question-post')


				div(class='errors')
					+validationErrorSummary(errors)

				input(type='hidden' name='_csrf' value=csrfToken)

				textarea(class='log-in-input answer-input' type="textarea" id="content" name="content" placeholder="Leave a flo-Answer..")

				if locals.authenticated
					div(class='new-question-footer')
						button(type='submit' class='btn log-in-submit new-question-btn') Submit
					div(class='test-4')
						div(class='test-4')
				else
					a(href='/login') Please login to ask a flo question
					//-need updateQuestionContent,updateQuestionButton as Id for dynamic editing; Do not change. Otherwise, need to update in js file
					//- button not in form because it will not submit the texarea, but the testarea will be showned once the button is clicked
			//- div #{question.Answers.length|0} Answers

		else
			div This question does not exist.
